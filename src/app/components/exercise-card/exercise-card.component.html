<div class="exercise-card" 
     [class.clickable]="clickable && !allowSelection" 
     [class.selected]="isSelected"
     [class.compact]="variant === 'compact'"
     (click)="onCardClick()"
     (keydown.enter)="onCardClick()"
     (keydown.space)="onCardClick()"
     [attr.tabindex]="clickable && !allowSelection ? 0 : -1"
     [attr.role]="clickable && !allowSelection ? 'button' : null">
  <div class="card-media">
    <img *ngIf="exercise.imageUrl || (exercise.media && exercise.media.length > 0)" 
         [src]="exercise.imageUrl || exercise.media![0]" 
         [alt]="exercise.name">
    <div class="media-placeholder" *ngIf="!exercise.imageUrl && (!exercise.media || exercise.media.length === 0)">
      <mat-icon>fitness_center</mat-icon>
      <span>No Image</span>
    </div>
    <div class="card-badge" 
         [style.background-color]="getCategoryColor(exercise.category)">
      {{ exercise.category }}
    </div>
    <div class="selection-indicator" *ngIf="isSelected && allowSelection">
      <mat-icon>check</mat-icon>
    </div>
  </div>
  <div class="card-content">
    <h3 class="exercise-name">{{ exercise.name }}</h3>
    
    <div class="exercise-category">
      <mat-chip class="category-chip">{{ exercise.category }}</mat-chip>
      <span class="difficulty-text">{{ exercise.difficulty }}</span>
    </div>

    <p class="exercise-description">{{ exercise.description }}</p>

    <div class="exercise-tags" *ngIf="exercise.tags && exercise.tags.length > 0">
      <mat-chip class="tag-chip" *ngFor="let tag of exercise.tags">{{ tag }}</mat-chip>
    </div>

    <div class="exercise-details">
      <div class="detail-item" *ngIf="exercise.targetMuscles && exercise.targetMuscles.length > 0">
        <mat-icon>location_on</mat-icon>
        <span [matTooltip]="getTargetMusclesDisplay()">{{ getTargetMusclesDisplay() }}</span>
      </div>
      <div class="detail-item" *ngIf="exercise.equipment && exercise.equipment.length > 0">
        <mat-icon>fitness_center</mat-icon>
        <span [matTooltip]="getEquipmentDisplay()">{{ getEquipmentDisplay() }}</span>
      </div>
      <div class="detail-item" *ngIf="exercise.sets && exercise.sets.length > 0">
        <mat-icon>repeat</mat-icon>
        <span>{{ getSetsDisplay() }}</span>
      </div>
    </div>

    <div class="card-actions" *ngIf="showActions || allowSelection">
      <button 
        *ngIf="allowSelection"
        mat-stroked-button 
        class="action-btn select-btn"
        [color]="isSelected ? 'warn' : 'primary'"
        (click)="onSelect($event)"
        [matTooltip]="isSelected ? 'Remove from selection' : 'Add to selection'">
        <mat-icon>{{ isSelected ? 'remove_circle' : 'add_circle' }}</mat-icon>
        {{ isSelected ? 'Remove' : 'Add' }}
      </button>
      <button 
        *ngIf="showActions"
        mat-stroked-button 
        class="action-btn view-btn" 
        (click)="onView($event)"
        matTooltip="View exercise">
        <mat-icon>visibility</mat-icon>
        View
      </button>
      <button 
        *ngIf="showActions"
        mat-stroked-button 
        class="action-btn edit-btn" 
        (click)="onEdit($event)"
        matTooltip="Edit exercise">
        <mat-icon>edit</mat-icon>
        Edit
      </button>
      <button 
        *ngIf="showActions && !allowSelection"
        mat-stroked-button 
        class="action-btn delete-btn" 
        (click)="onDelete($event)"
        matTooltip="Delete exercise">
        <mat-icon>delete</mat-icon>
        Delete
      </button>
    </div>
  </div>
</div>

