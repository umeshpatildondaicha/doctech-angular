<div class="profile-container">
  <!-- Page Header -->
  <div class="page-header">
    <div class="header-content">
      <div class="title-section">
        <app-icon [fontIcon]="'person'" [size]="32" [color]="'white'" class="title-icon"></app-icon>
        <h1 class="page-title">Doctor Profile</h1>
      </div>
      <div class="header-actions">
        <app-button
          type="button"
          [appearance]="'raised'"
          [color]="'primary'"
          [fontIcon]="'edit'"
          (btnClick)="onEdit()"
          [text]="'Edit Profile'"
          class="edit-btn"
          *ngIf="!isEditing">
        </app-button>
      </div>
    </div>
  </div>

  <!-- Profile Content -->
  <div class="profile-content">
    <div class="profile-card">
      <!-- Profile Header -->
      <div class="profile-header">
        <div class="header-background"></div>
        <div class="avatar-section">
          <div class="avatar-container">
            <div class="avatar">
              <app-icon [fontIcon]="'person'" [size]="48" [color]="'white'" class="avatar-icon"></app-icon>
            </div>
            <div class="avatar-badge" *ngIf="isEditing">
              <app-icon [fontIcon]="'camera_alt'" [size]="16" [color]="'white'"></app-icon>
            </div>
          </div>
          <div class="profile-info">
            <h2 class="profile-name">{{ profileForm.get('firstName')?.value }} {{ profileForm.get('lastName')?.value }}</h2>
            <p class="profile-role">{{ profileForm.get('specialization')?.value }}</p>
            <div class="profile-stats">
              <div class="stat-item">
                <app-icon [fontIcon]="'schedule'" [size]="16" [color]="'rgba(255, 255, 255, 0.9)'"></app-icon>
                <span>{{ profileForm.get('experience')?.value }} years experience</span>
              </div>
              <div class="stat-item">
                <app-icon [fontIcon]="'verified'" [size]="16" [color]="'rgba(255, 255, 255, 0.9)'"></app-icon>
                <span>License: {{ profileForm.get('licenseNumber')?.value }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Profile Form -->
      <form [formGroup]="profileForm" class="profile-form">
        
        <!-- Personal Information Section -->
        <div class="form-section">
          <div class="section-header">
            <app-icon [fontIcon]="'person_outline'" [size]="24" [color]="'#3b82f6'"></app-icon>
            <h3 class="section-title">Personal Information</h3>
          </div>
          <div class="form-grid">
            <div class="form-row">
              <app-input
                label="First Name"
                formControlName="firstName"
                placeholder="Enter first name"
                [required]="true"
                [errorMessage]="getErrorMessage('firstName')"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row">
              <app-input
                label="Last Name"
                formControlName="lastName"
                placeholder="Enter last name"
                [required]="true"
                [errorMessage]="getErrorMessage('lastName')"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row">
              <app-input
                label="Email Address"
                formControlName="email"
                placeholder="Enter email address"
                type="email"
                [required]="true"
                [errorMessage]="getErrorMessage('email')"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row">
              <app-input
                label="Phone Number"
                formControlName="phone"
                placeholder="Enter phone number"
                [required]="true"
                [errorMessage]="getErrorMessage('phone')"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row">
              <app-input
                label="Date of Birth"
                formControlName="dateOfBirth"
                placeholder="Select date of birth"
                type="date"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row">
              <app-selectbox
                label="Gender"
                formControlName="gender"
                [options]="['Male', 'Female', 'Other']"
                [disabled]="!isEditing"
                class="form-field">
              </app-selectbox>
            </div>
          </div>
        </div>

        <!-- Professional Information Section -->
        <div class="form-section">
          <div class="section-header">
            <app-icon [fontIcon]="'medical_services'" [size]="24" [color]="'#3b82f6'"></app-icon>
            <h3 class="section-title">Professional Information</h3>
          </div>
          <div class="form-grid">
            <div class="form-row">
              <app-selectbox
                label="Specialization"
                formControlName="specialization"
                [options]="specializations"
                [required]="true"
                [errorMessage]="getErrorMessage('specialization')"
                [disabled]="!isEditing"
                class="form-field">
              </app-selectbox>
            </div>

            <div class="form-row">
              <app-input
                label="Qualifications"
                formControlName="qualifications"
                placeholder="e.g., MBBS, MD - Internal Medicine"
                [required]="true"
                [errorMessage]="getErrorMessage('qualifications')"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row">
              <app-input
                label="Years of Experience"
                formControlName="experience"
                placeholder="Enter years of experience"
                type="number"
                [required]="true"
                [errorMessage]="getErrorMessage('experience')"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row">
              <app-input
                label="License Number"
                formControlName="licenseNumber"
                placeholder="Enter license number"
                [required]="true"
                [errorMessage]="getErrorMessage('licenseNumber')"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row">
              <app-input
                label="Affiliated Hospitals"
                formControlName="affiliatedHospitals"
                placeholder="Enter affiliated hospitals"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row">
              <app-selectbox
                label="Working Hours"
                formControlName="workingHours"
                [options]="availabilityOptions"
                [disabled]="!isEditing"
                class="form-field">
              </app-selectbox>
            </div>

            <div class="form-row full-width">
              <label class="form-label">Languages Spoken</label>
              <div class="chips-container">
                <mat-chip-listbox formControlName="languagesSpoken" [disabled]="!isEditing">
                  <mat-chip-option *ngFor="let language of profileForm.get('languagesSpoken')?.value" 
                                  [value]="language" 
                                  (removed)="removeLanguage(language)">
                    {{ language }}
                    <mat-icon matChipRemove *ngIf="isEditing">cancel</mat-icon>
                  </mat-chip-option>
                </mat-chip-listbox>
                <app-selectbox
                  *ngIf="isEditing"
                  [options]="languages"
                  placeholder="Add language"
                  (dataChange)="addLanguage($event)"
                  class="add-chip-select">
                </app-selectbox>
              </div>
            </div>
          </div>
        </div>

        <!-- Medical Practice Section -->
        <div class="form-section">
          <div class="section-header">
            <app-icon [fontIcon]="'healing'" [size]="24" [color]="'#3b82f6'"></app-icon>
            <h3 class="section-title">Medical Practice</h3>
          </div>
          <div class="form-grid">
            <div class="form-row full-width">
              <app-input
                label="Treatments Offered"
                formControlName="treatmentsOffered"
                placeholder="List treatments and services offered"
                [multiline]="true"
                [rows]="3"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row full-width">
              <app-input
                label="Procedures Performed"
                formControlName="proceduresPerformed"
                placeholder="List medical procedures performed"
                [multiline]="true"
                [rows]="3"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row full-width">
              <label class="form-label">Patient Age Groups</label>
              <div class="checkbox-group">
                <mat-checkbox formControlName="patientAgeGroups" value="Children" [disabled]="!isEditing">
                  Children
                </mat-checkbox>
                <mat-checkbox formControlName="patientAgeGroups" value="Adults" [disabled]="!isEditing">
                  Adults
                </mat-checkbox>
                <mat-checkbox formControlName="patientAgeGroups" value="Elderly" [disabled]="!isEditing">
                  Elderly
                </mat-checkbox>
              </div>
            </div>
          </div>
        </div>

        <!-- Departments & Affiliations Section -->
        <div class="form-section">
          <div class="section-header">
            <app-icon [fontIcon]="'business'" [size]="24" [color]="'#3b82f6'"></app-icon>
            <h3 class="section-title">Departments & Affiliations</h3>
          </div>
          <div class="form-grid">
            <div class="form-row full-width">
              <label class="form-label">Associated Departments</label>
              <div class="chips-container">
                <mat-chip-listbox formControlName="associatedDepartments" [disabled]="!isEditing">
                  <mat-chip-option *ngFor="let dept of profileForm.get('associatedDepartments')?.value" 
                                  [value]="dept" 
                                  (removed)="removeDepartment(dept)">
                    {{ dept }}
                    <mat-icon matChipRemove *ngIf="isEditing">cancel</mat-icon>
                  </mat-chip-option>
                </mat-chip-listbox>
                <app-selectbox
                  *ngIf="isEditing"
                  [options]="departments"
                  placeholder="Add department"
                  (dataChange)="addDepartment($event)"
                  class="add-chip-select">
                </app-selectbox>
              </div>
            </div>

            <div class="form-row">
              <app-input
                label="Hospital Affiliations"
                formControlName="hospitalAffiliations"
                placeholder="Enter hospital affiliations"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row">
              <app-input
                label="Clinic Affiliations"
                formControlName="clinicAffiliations"
                placeholder="Enter clinic affiliations"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>
          </div>
        </div>

        <!-- Fees & Consultation Section -->
        <div class="form-section">
          <div class="section-header">
            <app-icon [fontIcon]="'attach_money'" [size]="24" [color]="'#3b82f6'"></app-icon>
            <h3 class="section-title">Fees & Consultation</h3>
          </div>
          <div class="form-grid">
            <div class="form-row">
              <app-input
                label="Regular Consultation Fee ($)"
                formControlName="consultationFee"
                placeholder="Enter consultation fee"
                type="number"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row">
              <app-input
                label="Follow-up Fee ($)"
                formControlName="followUpFee"
                placeholder="Enter follow-up fee"
                type="number"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row">
              <app-input
                label="Emergency Fee ($)"
                formControlName="emergencyFee"
                placeholder="Enter emergency fee"
                type="number"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row">
              <app-input
                label="Online Consultation Fee ($)"
                formControlName="onlineConsultationFee"
                placeholder="Enter online consultation fee"
                type="number"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row">
              <mat-checkbox formControlName="insuranceAccepted" [disabled]="!isEditing">
                Accept Insurance
              </mat-checkbox>
            </div>

            <div class="form-row full-width">
              <label class="form-label">Payment Methods Accepted</label>
              <div class="checkbox-group">
                <mat-checkbox formControlName="paymentMethods" value="Cash" [disabled]="!isEditing">
                  Cash
                </mat-checkbox>
                <mat-checkbox formControlName="paymentMethods" value="Credit Card" [disabled]="!isEditing">
                  Credit Card
                </mat-checkbox>
                <mat-checkbox formControlName="paymentMethods" value="Insurance" [disabled]="!isEditing">
                  Insurance
                </mat-checkbox>
                <mat-checkbox formControlName="paymentMethods" value="Online Payment" [disabled]="!isEditing">
                  Online Payment
                </mat-checkbox>
              </div>
            </div>
          </div>
        </div>

        <!-- Availability & Telemedicine Section -->
        <div class="form-section">
          <div class="section-header">
            <app-icon [fontIcon]="'schedule'" [size]="24" [color]="'#3b82f6'"></app-icon>
            <h3 class="section-title">Availability & Telemedicine</h3>
          </div>
          <div class="form-grid">
            <div class="form-row">
              <app-selectbox
                label="Availability Schedule"
                formControlName="availabilitySchedule"
                [options]="availabilityOptions"
                [disabled]="!isEditing"
                class="form-field">
              </app-selectbox>
            </div>

            <div class="form-row">
              <app-input
                label="Appointment Slot Duration"
                formControlName="appointmentSlots"
                placeholder="e.g., 30 minutes"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row">
              <mat-checkbox formControlName="onlineConsultation" [disabled]="!isEditing">
                Available for Online Consultation
              </mat-checkbox>
            </div>

            <div class="form-row">
              <mat-checkbox formControlName="telemedicineAvailable" [disabled]="!isEditing">
                Telemedicine Available
              </mat-checkbox>
            </div>

            <div class="form-row">
              <mat-checkbox formControlName="emergencyAvailability" [disabled]="!isEditing">
                Emergency Availability
              </mat-checkbox>
            </div>
          </div>
        </div>

        <!-- Research & Publications Section -->
        <div class="form-section">
          <div class="section-header">
            <app-icon [fontIcon]="'school'" [size]="24" [color]="'#3b82f6'"></app-icon>
            <h3 class="section-title">Research & Publications</h3>
          </div>
          <div class="form-grid">
            <div class="form-row full-width">
              <app-input
                label="Research Interests"
                formControlName="researchInterests"
                placeholder="Enter research interests"
                [multiline]="true"
                [rows]="3"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row full-width">
              <app-input
                label="Publications"
                formControlName="publications"
                placeholder="List your publications"
                [multiline]="true"
                [rows]="4"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row full-width">
              <app-input
                label="Case Studies"
                formControlName="caseStudies"
                placeholder="List notable case studies"
                [multiline]="true"
                [rows]="4"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row full-width">
              <app-input
                label="Awards & Recognition"
                formControlName="awards"
                placeholder="List awards and recognition"
                [multiline]="true"
                [rows]="3"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row full-width">
              <app-input
                label="Professional Memberships"
                formControlName="memberships"
                placeholder="List professional memberships"
                [multiline]="true"
                [rows]="3"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>
          </div>
        </div>

        <!-- Security & Settings Section -->
        <div class="form-section">
          <div class="section-header">
            <app-icon [fontIcon]="'security'" [size]="24" [color]="'#3b82f6'"></app-icon>
            <h3 class="section-title">Security & Settings</h3>
          </div>
          <div class="form-grid">
            <div class="form-row">
              <mat-checkbox formControlName="twoFactorAuth" [disabled]="!isEditing">
                Enable Two-Factor Authentication
              </mat-checkbox>
            </div>

            <div class="form-row">
              <app-selectbox
                label="Profile Visibility"
                formControlName="profileVisibility"
                [options]="['Public', 'Private', 'Patients Only']"
                [disabled]="!isEditing"
                class="form-field">
              </app-selectbox>
            </div>

            <div class="form-row full-width">
              <label class="form-label">Notification Preferences</label>
              <div class="checkbox-group">
                <mat-checkbox formControlName="smsNotifications" [disabled]="!isEditing">
                  SMS Notifications
                </mat-checkbox>
                <mat-checkbox formControlName="emailNotifications" [disabled]="!isEditing">
                  Email Notifications
                </mat-checkbox>
                <mat-checkbox formControlName="appNotifications" [disabled]="!isEditing">
                  App Notifications
                </mat-checkbox>
              </div>
            </div>

            <div class="form-row">
              <mat-checkbox formControlName="googleCalendarSync" [disabled]="!isEditing">
                Sync with Google Calendar
              </mat-checkbox>
            </div>

            <div class="form-row">
              <mat-checkbox formControlName="outlookCalendarSync" [disabled]="!isEditing">
                Sync with Outlook Calendar
              </mat-checkbox>
            </div>

            <div class="form-row">
              <mat-checkbox formControlName="autoScheduleAppointments" [disabled]="!isEditing">
                Auto-schedule Appointments
              </mat-checkbox>
            </div>
          </div>
        </div>

        <!-- About Me Section -->
        <div class="form-section">
          <div class="section-header">
            <app-icon [fontIcon]="'description'" [size]="24" [color]="'#3b82f6'"></app-icon>
            <h3 class="section-title">About Me</h3>
          </div>
          <div class="form-grid">
            <div class="form-row full-width">
              <app-input
                label="Professional Bio"
                formControlName="bio"
                placeholder="Tell us about your professional background, expertise, and approach to patient care..."
                [required]="true"
                [multiline]="true"
                [rows]="6"
                [errorMessage]="getErrorMessage('bio')"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>

            <div class="form-row full-width">
              <app-input
                label="Personal Statement"
                formControlName="aboutMe"
                placeholder="Share a personal statement about your approach to healthcare..."
                [multiline]="true"
                [rows]="4"
                [disabled]="!isEditing"
                class="form-field">
              </app-input>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="form-actions" *ngIf="isEditing">
          <div class="action-buttons">
            <app-button
              type="button"
              [appearance]="'basic'"
              [color]="'accent'"
              [fontIcon]="'close'"
              (btnClick)="onCancel()"
              [text]="'Cancel'"
              class="cancel-btn">
            </app-button>

            <app-button
              type="button"
              [appearance]="'raised'"
              [color]="'primary'"
              [fontIcon]="'save'"
              (btnClick)="onSave()"
              [disabled]="profileForm.invalid"
              [text]="'Save Changes'"
              class="save-btn">
            </app-button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
