<div class="diet-create-dialog" [class.view-mode]="isViewMode">
  <!-- Dialog Header -->
  <div class="dialog-header">
    <div class="header-content">
      <div class="title-section">
        <app-icon [fontIcon]="'restaurant'" class="title-icon"></app-icon>
        <h2 class="title">{{ dialogTitle }}</h2>
      </div>
        <app-icon [fontIcon]="'close'" (iconClick)="onCancel()"></app-icon>
    </div>
  </div>

  <!-- Dialog Content -->
  <div class="dialog-content">
    <form [formGroup]="dietForm" (ngSubmit)="onSubmit()" class="form">
      <div class="section-title-wrapper"><h4 class="section-title">Diet details</h4></div>
      <div class="form-row">
          <app-uploadbox
            class="uploadbox"
            [multiple]="true"
            accept="image/*,.pdf"
            [maxFileSize]="5 * 1024 * 1024"
            [maxFiles]="3"
            placeholder="Drop files here"
            (filesSelected)="onFilesSelected($event)"
            (fileUploaded)="onFileUploaded($event)">
          </app-uploadbox>
      </div>
      <div class="form-row">
        <app-input
          label="Diet Name"
          formControlName="name"
          placeholder="Enter diet name"
          [required]="true"
          [errorMessage]="getErrorMessage('name')"
          class="form-field">
        </app-input>
      </div>

      <div class="form-row">
        <app-input
          label="Description"
          formControlName="description"
          placeholder="Enter diet description"
          [required]="true"
          [multiline]="true"
          [rows]="3"
          [errorMessage]="getErrorMessage('description')"
          class="form-field">
        </app-input>
      </div>

      <div class="form-row">
        <app-selectbox
          label="Diet Type"
          formControlName="dietType"
          [options]="dietTypes"
          placeholder="Select diet type"
          [required]="true"
          [displayExpr]="'label'"
          [errorMessage]="getErrorMessage('dietType')"
          class="form-field">
        </app-selectbox>
      </div>

      <div class="nutrition-section">
        <h4 class="section-title">Nutritional Information</h4>
        
        <div class="nutrition-grid">
          <div class="form-row">
            <app-input
              label="Calories (kcal)"
              formControlName="calories"
              placeholder="Enter calories"
              type="number"
              [required]="true"
              [errorMessage]="getErrorMessage('calories')"
              class="form-field">
            </app-input>
          </div>

          <div class="form-row">
            <app-input
              label="Protein (g)"
              formControlName="protein"
              placeholder="Enter protein"
              type="number"
              [required]="true"
              [errorMessage]="getErrorMessage('protein')"
              class="form-field">
            </app-input>
          </div>

          <div class="form-row">
            <app-input
              label="Carbohydrates (g)"
              formControlName="carbs"
              placeholder="Enter carbs"
              type="number"
              [required]="true"
              [errorMessage]="getErrorMessage('carbs')"
              class="form-field">
            </app-input>
          </div>

          <div class="form-row">
            <app-input
              label="Fat (g)"
              formControlName="fat"
              placeholder="Enter fat"
              type="number"
              [required]="true"
              [errorMessage]="getErrorMessage('fat')"
              class="form-field">
            </app-input>
          </div>

          <div class="form-row">
            <app-input
              label="Fiber (g)"
              formControlName="fiber"
              placeholder="Enter fiber"
              type="number"
              [required]="true"
              [errorMessage]="getErrorMessage('fiber')"
              class="form-field">
            </app-input>
          </div>
        </div>
      </div>
    </form>
  </div>

  <!-- Dialog Footer -->
  <div class="dialog-footer">
    <div class="footer-actions">
      <app-button
        type="button"
        *ngIf="!isViewMode"
        appearance="basic"
        (btnClick)="onCancel()"
        [text]="'Cancel'"
        class="cancel-btn">
      </app-button>

      <!-- Edit button for view mode -->
      <!-- <app-button
        *ngIf="showEditButton"
        type="button"
        appearance="raised"
        (btnClick)="onEdit()"
        [text]="'Edit'"
        class="edit-btn">
      </app-button> -->

      <!-- Submit button for create/edit mode, Close button for view mode -->
      <app-button
        type="button"
        [appearance]="isViewMode ? 'basic' : 'raised'"
        [disabled]="dietForm.invalid && !isViewMode"
        (btnClick)="onSubmit()"
        [text]="submitButtonText"
        class="submit-btn">
      </app-button>
    </div>
  </div>
</div>
