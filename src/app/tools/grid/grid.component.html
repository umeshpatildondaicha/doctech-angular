<div class="grid-container">
  <!-- Enhanced Grid Header -->
  <div class="grid-header" *ngIf="showHeader">
    <div class="header-left">
      <div class="grid-title">
        <h3 class="title-text">Data Grid</h3>
        <span class="subtitle-text">{{ filteredRowData.length || 0 }} records</span>
      </div>
    </div>
    
    <div class="header-center">
      <div class="search-section">
        <app-input
          [placeholder]="searchPlaceholder"
          [value]="searchText"
          [prefixIconName]="'search'"
          (valueChange)="onSearchChange($event)"
          [search]="true"
          class="search-input">
        </app-input>
      </div>
    </div>
    
    <div class="header-right">
      <div class="action-buttons">
        <ng-container *ngTemplateOutlet="rightTooltemplateRef"></ng-container>
        
        <button class="action-btn refresh-btn" (click)="onRefresh()" title="Refresh Data">
          <app-icon 
            fontSet="material-icons-outlined" 
            fontIcon="refresh" 
            [size]="18">
          </app-icon>
          <span class="btn-text">Refresh</span>
        </button>
        
        <button class="action-btn filter-btn" (click)="onFilterClick()" title="Advanced Filters">
          <app-icon 
            fontSet="material-icons-outlined" 
            fontIcon="filter_list" 
            [size]="18">
          </app-icon>
          <span class="btn-text">Filter</span>
          <span class="filter-badge" *ngIf="activeFiltersCount > 0">{{ activeFiltersCount }}</span>
        </button>
        
        <button class="action-btn export-btn" (click)="onExport()" title="Export Data">
          <app-icon 
            fontSet="material-icons-outlined" 
            fontIcon="file_download" 
            [size]="18">
          </app-icon>
          <span class="btn-text">Export</span>
        </button>
<!-- 
        <div class="view-toggle" *ngIf="cardTemplate">
          <button 
            class="view-btn" 
            [class.active]="viewMode === 'list'"
            (click)="switchToListView()" 
            title="List View">
            <app-icon fontIcon="view_list" [size]="18"></app-icon>
          </button>
          <button 
            class="view-btn" 
            [class.active]="viewMode === 'card'"
            (click)="switchToCardView()" 
            title="Card View">
            <app-icon fontIcon="view_module" [size]="18"></app-icon>
          </button>
        </div> -->
      </div>
    </div>
  </div>
  
  <!-- Modern Grid Content -->
  <div class="grid-content">
    <div class="grid-wrapper">
      <!-- List View (AG-Grid) -->
      <ag-grid-angular
        *ngIf="isBrowser && viewMode === 'list'"
        [rowData]="filteredRowData"
        class="modern-grid ag-theme-alpine"
        [columnDefs]="processedColumnDefs"
        [gridOptions]="gridOptions"
        [domLayout]="domLayout"
        [animateRows]="animateRows"
        [class]="class"
        [style.width]="width"
        [style.height]="'100%'"
        (rowClicked)="onRowClicked($event)"
        >
      </ag-grid-angular>

      <!-- Card View (Custom Template) -->
      <div class="card-grid" *ngIf="isBrowser && viewMode === 'card' && cardTemplate">
        <ng-container *ngFor="let item of filteredRowData">
          <ng-container *ngTemplateOutlet="cardTemplate; context: { $implicit: item }"></ng-container>
        </ng-container>
      </div>
      
      <!-- Loading State -->
      <div class="grid-loading" *ngIf="!isBrowser">
        <div class="loading-spinner"></div>
        <span>Loading grid...</span>
      </div>
      
      <!-- Empty State -->
      <div class="grid-empty" *ngIf="isBrowser && (!filteredRowData || filteredRowData.length === 0)">
        <div class="empty-icon">
          <app-icon 
            fontSet="material-icons-outlined" 
            fontIcon="table_chart" 
            [size]="48">
          </app-icon>
        </div>
        <h4>No Data Available</h4>
        <p>There are no records to display at the moment.</p>
        <button class="empty-action-btn" (click)="onRefresh()">
          <app-icon 
            fontSet="material-icons-outlined" 
            fontIcon="refresh" 
            [size]="16">
          </app-icon>
          Refresh Data
        </button>
      </div>
    </div>
  </div>
</div>
