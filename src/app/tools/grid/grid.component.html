<div class="grid-container">
  <!-- Clean Grid Toolbar -->
  <div class="grid-toolbar" *ngIf="showHeader">
    <div class="toolbar-left">
      <span class="pagination-info">Displaying {{ displayedRows }} of {{ totalRows }}</span>
      
      <!-- Filter Chips -->
      <div class="filter-chips" *ngIf="activeFilterChips.length > 0">
        <div class="filter-chip" *ngFor="let chip of activeFilterChips">
          <span class="chip-label">{{ chip.label }}:</span>
          <span class="chip-value">{{ chip.value }}</span>
          <button type="button" class="chip-remove" (click)="removeFilterChip(chip.field)" title="Remove filter" aria-label="Remove filter">Ã—</button>
        </div>
      </div>
    </div>
    
    <div class="toolbar-center">
      <div class="search-section">
        <app-input
          [placeholder]="searchPlaceholder"
          [value]="searchText"
          [prefixIconName]="'search'"
          (valueChange)="onSearchChange($event)"
          [search]="true"
          class="search-input">
        </app-input>
      </div>
    </div>
    
    <div class="toolbar-right">
      <div class="action-icons">
        <ng-container *ngTemplateOutlet="rightTooltemplateRef"></ng-container>
        
        <button class="icon-btn add-btn" (click)="onAddClick()" title="Add New" *ngIf="showAddButton">
          <mat-icon>add_circle_outline</mat-icon>
        </button>
        
        <button class="icon-btn refresh-btn" (click)="onRefresh()" title="Refresh">
          <mat-icon>sync</mat-icon>
        </button>
        
        <button class="icon-btn filter-btn" (click)="onFilterClick()" title="Filter" [class.active]="activeFiltersCount > 0">
          <mat-icon>tune</mat-icon>
        </button>
        
        <button class="icon-btn settings-btn" (click)="onColumnSettingsClick()" title="Column Settings">
          <mat-icon>settings_applications</mat-icon>
        </button>
      </div>
    </div>
  </div>
  
  <!-- Grid Content -->
  <div class="grid-content">
    <div class="grid-wrapper">
      <!-- List View (AG-Grid) -->
      <ag-grid-angular
        *ngIf="isBrowser && viewMode === 'list'"
        [rowData]="filteredRowData"
        class="clean-grid ag-theme-clean"
        [columnDefs]="processedColumnDefs"
        [gridOptions]="gridOptions"
        [domLayout]="domLayout"
        [animateRows]="animateRows"
        [class]="class"
        [style.width]="width"
        [style.height]="'100%'"
        (gridReady)="onGridReady($event)"
        (modelUpdated)="onModelUpdated($event)"
        (rowClicked)="onRowClicked($event)">
      </ag-grid-angular>

      <!-- Card View (Custom Template) -->
      <div class="card-grid" *ngIf="isBrowser && viewMode === 'card' && cardTemplate">
        <ng-container *ngFor="let item of filteredRowData">
          <ng-container *ngTemplateOutlet="cardTemplate; context: { $implicit: item }"></ng-container>
        </ng-container>
      </div>
      
      <!-- Loading State -->
      <div class="grid-loading" *ngIf="!isBrowser">
        <div class="loading-spinner"></div>
        <span>Loading grid...</span>
      </div>
    </div>
  </div>
</div>
